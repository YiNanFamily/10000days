<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10000å¤©å¿«ä¹ï¼</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/css/lg-thumbnail.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>äº²çˆ±çš„æ¥ æ¥ å®ï¼Œ10000å¤©å¿«ä¹ï¼</h1>
        <p>æ¯ä¸€ä¸ªç›¸å†Œï¼Œéƒ½çè—ç€ä¸€äº›ä¸“å±äºä½ çš„æ•…äº‹ã€‚å‰è·¯æœªå¤®ï¼Œå…±èµ´å±±æµ·ï¼Œæ„¿ä½ æ°¸è¿œè¢«çˆ±å’Œå¿«ä¹åŒ…å›´ï¼</p>
        <button id="play-music-btn">ğŸµ æ¥ç‚¹éŸ³ä¹å§</button>
    </header>

    <main class="gallery-container">
        <div class="gallery" id="gallery-grid">
            <p class="loading-message">æ­£åœ¨ä¸ºä½ åŠ è½½ä¸“å±å›å¿†ï¼Œè¯·ç¨å€™...</p>
        </div>
    </main>

    <footer>
        <p>æ°¸è¿œçˆ±ä½ çš„å‘†å­é™ˆä¸€</p>
        <p>&copy; 2025.06.14 - Just for You</p>
    </footer>

    <audio id="bg-music" loop></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/lightgallery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/plugins/thumbnail/lg-thumbnail.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        
            // =========================================================================
            // ========= ä½ å”¯ä¸€éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼šä½ çš„9ä¸ªç›¸å†Œé…ç½® ============
            // =========================================================================
            const galleries = [
                { title: "ç‹¬å®¶ç²¾é€‰", folder: "Selected" },
                { title: "å½“ç„¶è¦åˆç…§å•¦", folder: "Together" },
                { title: "ç¯çƒæ—…è¡Œè¿›è¡Œä¸­", folder: "Travel" },
                { title: "é‚£äº›é—ªé—ªå‘å…‰çš„æ—¥å­", folder: "Anniversary" },
                { title: "çˆ±å°±æ˜¯ä¸€èµ·åƒå¥½å¤šé¡¿é¥­", folder: "Food" },
                { title: "é™ªä½ æ—¥å¸¸ä¹Ÿæ˜¯ææ¬¢å–œ", folder: "Daily" },
                { title: "æˆ‘ä»¬è§£é”çš„æ–°æŠ€èƒ½", folder: "Activities" },
                { title: "æ•…äº‹å¼€å§‹ä¹‹å‰", folder: "Past" },
                { title: "æœªå®Œå¾…ç»­", folder: "TBD" }
            ];
        
            // =========================================================================
            // ====================== ä»¥ä¸‹ä»£ç æ— éœ€ä¿®æ”¹ ========================
            // =========================================================================
        
            // æ–°å¢ï¼å®šä¹‰æœ€å¤§è¿ç»­ç©ºç¼ºæ•°ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿™ä¸ªå€¼
            const MAX_SEQUENTIAL_GAPS = 100;
        
            const galleryGrid = document.getElementById('gallery-grid');
            const loadingMessage = document.querySelector('.loading-message');
        
            // æ¢æµ‹å•ä¸ªæ•°å­—çš„å›¾ç‰‡æ˜¯å¦å­˜åœ¨ (å¤„ç†å¤šç§æ ¼å¼)
            async function probeImageForNumber(basePath, number) {
                const extensions = ['jpg', 'png', 'jpeg', 'gif', 'heic', 'webp'];
                for (const ext of extensions) {
                    const path = `${basePath}/${number}.${ext}`;
                    try {
                        await new Promise((resolve, reject) => {
                            const img = new Image();
                            img.onload = resolve;
                            img.onerror = reject;
                            img.src = path;
                        });
                        return path; // æˆåŠŸåˆ™è¿”å›è·¯å¾„
                    } catch (error) {
                        continue; // å¤±è´¥åˆ™å°è¯•ä¸‹ä¸ªæ ¼å¼
                    }
                }
                return null; // æ‰€æœ‰æ ¼å¼éƒ½å¤±è´¥
            }
        
            // å…¨æ–°ï¼æ›´æ™ºèƒ½çš„å›¾ç‰‡æŸ¥æ‰¾å‡½æ•°
            async function findImagesInFolder(folderPath) {
                const foundPaths = [];
                let currentNumber = 1;
                let gapCounter = 0;
        
                while (gapCounter < MAX_SEQUENTIAL_GAPS) {
                    const imagePath = await probeImageForNumber(folderPath, currentNumber);
                    
                    if (imagePath) {
                        foundPaths.push(imagePath);
                        gapCounter = 0; // æ‰¾åˆ°å›¾ç‰‡ï¼Œç©ºç¼ºè®¡æ•°æ¸…é›¶
                    } else {
                        gapCounter++; // æœªæ‰¾åˆ°å›¾ç‰‡ï¼Œç©ºç¼ºè®¡æ•°åŠ ä¸€
                    }
                    currentNumber++;
                }
                return foundPaths;
            }
        
            async function createGalleries() {
                if (loadingMessage) loadingMessage.style.display = 'none';
        
                let galleryIdCounter = 1;
                for (const galleryInfo of galleries) {
                    const imagePaths = await findImagesInFolder(`images/${galleryInfo.folder}`);
        
                    if (imagePaths.length > 0) {
                        const galleryId = `gallery-album-${galleryIdCounter++}`;
                        const coverImage = imagePaths[0]; // é»˜è®¤æ‰¾åˆ°çš„ç¬¬ä¸€å¼ ä½œä¸ºå°é¢
        
                        const galleryItem = document.createElement('div');
                        galleryItem.id = galleryId;
                        galleryItem.className = 'gallery-item';
        
                        let htmlContent = `
                            <a href="${coverImage}">
                                <img src="${coverImage}" alt="${galleryInfo.title}">
                            </a>
                            <p class="caption">${galleryInfo.title}</p>
                        `;
                        
                        // ä»ç¬¬äºŒå¼ å¼€å§‹ï¼Œä½œä¸ºéšè—çš„å›¾é›†é¡¹
                        for (let j = 1; j < imagePaths.length; j++) {
                            htmlContent += `<a href="${imagePaths[j]}" style="display:none;"></a>`;
                        }
                        
                        galleryItem.innerHTML = htmlContent;
                        galleryGrid.appendChild(galleryItem);
        
                        // åˆå§‹åŒ– lightgallery, å…è®¸ä¸‹è½½
                        lightGallery(galleryItem, {
                            selector: 'a',
                            thumbnail: true,
                            download: true,
                        });
                    }
                }
            }
            createGalleries();
        
            // ====================== éŸ³ä¹æ’­æ”¾å™¨ä»£ç  (æ— éœ€ä¿®æ”¹) =====================
            const musicPlayer = document.getElementById('bg-music');
            const playBtn = document.getElementById('play-music-btn');
            const songTitleEl = document.getElementById('song-title');
            const progressBar = document.getElementById('progress-bar');
            
            const musicPlaylist = [
                'music/ã‚¯ãƒªã‚¹ãƒã‚¹ã‚½ãƒ³ã‚°.m4a',
                'music/The Scientist.mp3',
                'music/è¡—ç¯æ™šé¤.m4a'
            ];
            
            let currentSongIndex = 0;
        
            function loadSong(songIndex) {
                musicPlayer.src = musicPlaylist[songIndex];
                const songName = musicPlaylist[songIndex].split('/').pop().split('.').slice(0, -1).join('.');
                songTitleEl.textContent = `æ­£åœ¨æ’­æ”¾: ${songName}`;
            }
        
            function playNextSong() {
                currentSongIndex = (currentSongIndex + 1) % musicPlaylist.length;
                loadSong(currentSongIndex);
                musicPlayer.play();
            }
        
            playBtn.addEventListener('click', () => {
                if (musicPlayer.paused) {
                    if (!musicPlayer.src) {
                        loadSong(currentSongIndex);
                    }
                    musicPlayer.play();
                    playBtn.textContent = 'â¸ï¸ æš‚åœéŸ³ä¹';
                } else {
                    musicPlayer.pause();
                    playBtn.textContent = 'ğŸµ ç»§ç»­æ’­æ”¾';
                }
            });
        
            musicPlayer.addEventListener('ended', playNextSong);
        
            musicPlayer.addEventListener('timeupdate', () => {
                if (musicPlayer.duration) {
                    const progressPercent = (musicPlayer.currentTime / musicPlayer.duration) * 100;
                    progressBar.style.width = `${progressPercent}%`;
                }
            });
        
            const initialSongName = musicPlaylist[0].split('/').pop().split('.').slice(0, -1).join('.');
            songTitleEl.textContent = `å¾…æœº: ${initialSongName}`;
        });
        </script>
</body>
</html>